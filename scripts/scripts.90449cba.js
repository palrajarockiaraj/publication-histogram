"use strict";angular.module("publicationsApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","ui.bootstrap"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).otherwise({redirectTo:"/"})}]),angular.module("publicationsApp").controller("MainCtrl",["$scope","$http","AppConstants","util",function(a,b,c,d){a.chart={},a.chart.title="Publication Histogram",a.showChart=!1,a.chart.categories=[],a.chart.chartData=[],a.search=function(){b.get(c.WS_URL+"/search?query="+a.searchQuery+"&sort=CITED%20desc&format=json").then(function(b){if(b.data.resultList.result.length>0){var c=[];angular.forEach(b.data.resultList.result,function(a){c.push(a.pubYear)});var e=d.getCount(c);angular.forEach(e,function(c,e){var f={},g=d.findFirstMatchingPubYear(b.data.resultList.result,e);f.y=c,f.mostCited=g,a.chart.categories.push(e),a.chart.chartData.push(f)}),a.showChart=!0}else a.showChart=!1},function(a){console.log(a)})}}]),angular.module("publicationsApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("publicationsApp").directive("barChart",function(){return{template:"<div></div>",restrict:"E",scope:{chartOptions:"="},link:function(a,b){var c=window.Highcharts;c.chart(b[0],{chart:{type:"column",width:1e3},title:{text:a.chartOptions.title},credits:{enabled:!1},legend:{enabled:!1},xAxis:{categories:a.chartOptions.categories,title:{text:"Year"},crosshair:!0},yAxis:{min:0,title:{text:"Number Of Publications"}},tooltip:{headerFormat:'<span style="font-size:10px">Number Of Publications : <b>{point.y}</b></span><hr/><span style="font-size:10px">Most cited paper in <b>{point.key}</b></span>',pointFormat:'<table><tr><td style="color:{series.color};padding:0">Title: </td><td style="padding:0"><b>{point.mostCited.title}</b></td></tr><tr><td style="color:{series.color};padding:0">Journal Title: </td><td style="padding:0"><b>{point.mostCited.journalTitle}</b></td></tr><tr><td style="color:{series.color};padding:0">Cite Count: </td><td style="padding:0"><b>{point.mostCited.citedByCount}</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0},plotOptions:{column:{pointPadding:.2,borderWidth:0}},series:[{data:a.chartOptions.chartData}]})}}}),angular.module("publicationsApp").constant("AppConstants",{WS_URL:"https://www.ebi.ac.uk/europepmc/webservices/rest"}),angular.module("publicationsApp").factory("util",function(){var a=function(a){var b={};return a.forEach(function(a){b[a]=(b[a]||0)+1}),b},b=function(a,b){var c=a.filter(function(a){return a.pubYear===b})[0];return c};return{getCount:a,findFirstMatchingPubYear:b}}),angular.module("publicationsApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/main.html",'<!-- <div uib-alert class="alert-info" close="closeAlert($index)">A happy alert!</div> --> <form class="search-form" ng-submit="search()" name="searchForm" role="form" autocomplete="off" novalidate> <div class="row"> <div class="col-xs-12"> <div class="input-group input-group-lg"> <input type="text" ng-model="searchQuery" class="form-control input-lg" id="searchQuery" placeholder="Search Query" required> <div class="input-group-btn"> <button type="submit" ng-disabled="searchForm.$invalid" class="btn btn-defaul btn-lg">Search</button> </div><!-- /btn-group --> </div><!-- /input-group --> </div><!-- /.col-xs-12 --> </div><!-- /.row --> </form> <div class="row chart" ng-if="showChart"> <bar-chart chart-options="chart"></bar-chart> </div>')}]);